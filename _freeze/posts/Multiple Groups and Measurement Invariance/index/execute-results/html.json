{
  "hash": "99dde11ec9088a3e91a3f86ff2cb138c",
  "result": {
    "markdown": "---\ntitle: \"Multiple Groups and Measurement Invariance\"\nformat: \n  revealjs:\n    theme: league\n    transition: slide\n    background-transition: zoom\n    slide-number: c/t\n    show-slide-number: all\n    chalkboard: true\n    background-size: cover\n    smaller: true\n    echo: true\n    code-fold: true\n    code-summary: \"Show the code\"\nauthor: \"Dr Lazaros Gonidis\"\ndate: \"2025-04-4\"\nimage: \"image1.jpg\"\n---\n\n\n## Today's Aims\n\nToday we will talk about how we can apply SEM with multiple groups analysis. In essence we want to investigate whether there are groups that **behave** differently.\n\nIn terms of coding, this is a rather simple task. However, there are some important questions we need to ask first before we can even carry out the group analysis.\n\n## In Terms of Lavaan I\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lavaan)\nlibrary(semPlot)\n\ndf <- data(HolzingerSwineford1939)\n\nHS.model <- ' visual  =~ x1 + x2 + x3 \n              textual =~ x4 + x5 + x6\n              speed   =~ x7 + x8 + x9 '\n\nfit <- cfa(HS.model, data = HolzingerSwineford1939, meanstructure = TRUE)\n\nsummary(fit, fit.measures = TRUE, remove.unused = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6.17 ended normally after 35 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        30\n\n  Number of observations                           301\n\nModel Test User Model:\n                                                      \n  Test statistic                                85.306\n  Degrees of freedom                                24\n  P-value (Chi-square)                           0.000\n\nModel Test Baseline Model:\n\n  Test statistic                               918.852\n  Degrees of freedom                                36\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.931\n  Tucker-Lewis Index (TLI)                       0.896\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -3737.745\n  Loglikelihood unrestricted model (H1)      -3695.092\n                                                      \n  Akaike (AIC)                                7535.490\n  Bayesian (BIC)                              7646.703\n  Sample-size adjusted Bayesian (SABIC)       7551.560\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.092\n  90 Percent confidence interval - lower         0.071\n  90 Percent confidence interval - upper         0.114\n  P-value H_0: RMSEA <= 0.050                    0.001\n  P-value H_0: RMSEA >= 0.080                    0.840\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.060\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2                0.554    0.100    5.554    0.000\n    x3                0.729    0.109    6.685    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5                1.113    0.065   17.014    0.000\n    x6                0.926    0.055   16.703    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8                1.180    0.165    7.152    0.000\n    x9                1.082    0.151    7.155    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.408    0.074    5.552    0.000\n    speed             0.262    0.056    4.660    0.000\n  textual ~~                                          \n    speed             0.173    0.049    3.518    0.000\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                4.936    0.067   73.473    0.000\n   .x2                6.088    0.068   89.855    0.000\n   .x3                2.250    0.065   34.579    0.000\n   .x4                3.061    0.067   45.694    0.000\n   .x5                4.341    0.074   58.452    0.000\n   .x6                2.186    0.063   34.667    0.000\n   .x7                4.186    0.063   66.766    0.000\n   .x8                5.527    0.058   94.854    0.000\n   .x9                5.374    0.058   92.546    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.549    0.114    4.833    0.000\n   .x2                1.134    0.102   11.146    0.000\n   .x3                0.844    0.091    9.317    0.000\n   .x4                0.371    0.048    7.779    0.000\n   .x5                0.446    0.058    7.642    0.000\n   .x6                0.356    0.043    8.277    0.000\n   .x7                0.799    0.081    9.823    0.000\n   .x8                0.488    0.074    6.573    0.000\n   .x9                0.566    0.071    8.003    0.000\n    visual            0.809    0.145    5.564    0.000\n    textual           0.979    0.112    8.737    0.000\n    speed             0.384    0.086    4.451    0.000\n```\n:::\n:::\n\n\n## In Terms of Lavaan II\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- cfa(HS.model, data = HolzingerSwineford1939, group = \"school\", meanstructure = TRUE)\n\nsummary(fit, fit.measures = TRUE, remove.unused = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6.17 ended normally after 57 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        60\n\n  Number of observations per group:                   \n    Pasteur                                        156\n    Grant-White                                    145\n\nModel Test User Model:\n                                                      \n  Test statistic                               115.851\n  Degrees of freedom                                48\n  P-value (Chi-square)                           0.000\n  Test statistic for each group:\n    Pasteur                                     64.309\n    Grant-White                                 51.542\n\nModel Test Baseline Model:\n\n  Test statistic                               957.769\n  Degrees of freedom                                72\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.923\n  Tucker-Lewis Index (TLI)                       0.885\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -3682.198\n  Loglikelihood unrestricted model (H1)      -3624.272\n                                                      \n  Akaike (AIC)                                7484.395\n  Bayesian (BIC)                              7706.822\n  Sample-size adjusted Bayesian (SABIC)       7516.536\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.097\n  90 Percent confidence interval - lower         0.075\n  90 Percent confidence interval - upper         0.120\n  P-value H_0: RMSEA <= 0.050                    0.001\n  P-value H_0: RMSEA >= 0.080                    0.897\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.068\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\n\nGroup 1 [Pasteur]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2                0.394    0.122    3.220    0.001\n    x3                0.570    0.140    4.076    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5                1.183    0.102   11.613    0.000\n    x6                0.875    0.077   11.421    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8                1.125    0.277    4.057    0.000\n    x9                0.922    0.225    4.104    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.479    0.106    4.531    0.000\n    speed             0.185    0.077    2.397    0.017\n  textual ~~                                          \n    speed             0.182    0.069    2.628    0.009\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                4.941    0.095   52.249    0.000\n   .x2                5.984    0.098   60.949    0.000\n   .x3                2.487    0.093   26.778    0.000\n   .x4                2.823    0.092   30.689    0.000\n   .x5                3.995    0.105   38.183    0.000\n   .x6                1.922    0.079   24.321    0.000\n   .x7                4.432    0.087   51.181    0.000\n   .x8                5.563    0.078   71.214    0.000\n   .x9                5.418    0.079   68.440    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.298    0.232    1.286    0.198\n   .x2                1.334    0.158    8.464    0.000\n   .x3                0.989    0.136    7.271    0.000\n   .x4                0.425    0.069    6.138    0.000\n   .x5                0.456    0.086    5.292    0.000\n   .x6                0.290    0.050    5.780    0.000\n   .x7                0.820    0.125    6.580    0.000\n   .x8                0.510    0.116    4.406    0.000\n   .x9                0.680    0.104    6.516    0.000\n    visual            1.097    0.276    3.967    0.000\n    textual           0.894    0.150    5.963    0.000\n    speed             0.350    0.126    2.778    0.005\n\n\nGroup 2 [Grant-White]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2                0.736    0.155    4.760    0.000\n    x3                0.925    0.166    5.583    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5                0.990    0.087   11.418    0.000\n    x6                0.963    0.085   11.377    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8                1.226    0.187    6.569    0.000\n    x9                1.058    0.165    6.429    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.408    0.098    4.153    0.000\n    speed             0.276    0.076    3.639    0.000\n  textual ~~                                          \n    speed             0.222    0.073    3.022    0.003\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                4.930    0.095   51.696    0.000\n   .x2                6.200    0.092   67.416    0.000\n   .x3                1.996    0.086   23.195    0.000\n   .x4                3.317    0.093   35.625    0.000\n   .x5                4.712    0.096   48.986    0.000\n   .x6                2.469    0.094   26.277    0.000\n   .x7                3.921    0.086   45.819    0.000\n   .x8                5.488    0.087   63.174    0.000\n   .x9                5.327    0.085   62.571    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.715    0.126    5.676    0.000\n   .x2                0.899    0.123    7.339    0.000\n   .x3                0.557    0.103    5.409    0.000\n   .x4                0.315    0.065    4.870    0.000\n   .x5                0.419    0.072    5.812    0.000\n   .x6                0.406    0.069    5.880    0.000\n   .x7                0.600    0.091    6.584    0.000\n   .x8                0.401    0.094    4.249    0.000\n   .x9                0.535    0.089    6.010    0.000\n    visual            0.604    0.160    3.762    0.000\n    textual           0.942    0.152    6.177    0.000\n    speed             0.461    0.118    3.910    0.000\n```\n:::\n:::\n\n\n## Visualisation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsemPaths(fit)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-3-2.png){width=960}\n:::\n:::\n\n\n## That Looks Quite Simple Then!\n\n[LET ME TELL YOU SOMETHING!!!](https://www.youtube.com/shorts/18OOnHDat4E \"LET ME TELL YOU SOMETHING!!!\")\n\n## So, First Thing First: Measurement Invariance\n\nSure we want to compare groups. But how certain are we that our model ***works equally well for all groups*** (Does it measure equally what we expect it to measure?)\n\n\"*whether or not, under different conditions of observing and studying phenomena, measurement operations yield measures of the same attribute*\" ([Horn & Mcardle, 1992](https://www.tandfonline.com/doi/abs/10.1080/03610739208253916?casa_token=xjjlyuE5cNEAAAAA:cAjeJeQwflaXybazMKtHuWiGcj6rqIZV4A9Liw5yPVP9IyTY2SpSG8hIHuuHq0NBxFhGufalZqjg))\n\nIn simpler terms, using the same items across different groups we will be measuring the same construct.\n\n## Types of Invariance Tests\n\n1.  **Configural Invariance**\n2.  **Metric Invariance (Weak)**\n3.  **Scalar Invariance (Strong)**\n4.  Factor Variance Invariance\n5.  Error Variance Invariance (Strick Invariance)\n\n## Configural Invariance (a.k.a Structural Equivalence)\n\n1.  The aim is to demonstrate that the model fits the data across all groups\n2.  We examine **Fit Indices** and **Chi-square** across all groups\n3.  Good model fit indicates configural invariance across groups\n\n## Code in lavaan as usual\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# configural invariance\nfit1 <- cfa(HS.model, data = HolzingerSwineford1939, group = \"school\", meanstructure = TRUE)\n\nsummary(fit1, fit.measures = TRUE, remove.unused = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6.17 ended normally after 57 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        60\n\n  Number of observations per group:                   \n    Pasteur                                        156\n    Grant-White                                    145\n\nModel Test User Model:\n                                                      \n  Test statistic                               115.851\n  Degrees of freedom                                48\n  P-value (Chi-square)                           0.000\n  Test statistic for each group:\n    Pasteur                                     64.309\n    Grant-White                                 51.542\n\nModel Test Baseline Model:\n\n  Test statistic                               957.769\n  Degrees of freedom                                72\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.923\n  Tucker-Lewis Index (TLI)                       0.885\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -3682.198\n  Loglikelihood unrestricted model (H1)      -3624.272\n                                                      \n  Akaike (AIC)                                7484.395\n  Bayesian (BIC)                              7706.822\n  Sample-size adjusted Bayesian (SABIC)       7516.536\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.097\n  90 Percent confidence interval - lower         0.075\n  90 Percent confidence interval - upper         0.120\n  P-value H_0: RMSEA <= 0.050                    0.001\n  P-value H_0: RMSEA >= 0.080                    0.897\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.068\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\n\nGroup 1 [Pasteur]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2                0.394    0.122    3.220    0.001\n    x3                0.570    0.140    4.076    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5                1.183    0.102   11.613    0.000\n    x6                0.875    0.077   11.421    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8                1.125    0.277    4.057    0.000\n    x9                0.922    0.225    4.104    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.479    0.106    4.531    0.000\n    speed             0.185    0.077    2.397    0.017\n  textual ~~                                          \n    speed             0.182    0.069    2.628    0.009\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                4.941    0.095   52.249    0.000\n   .x2                5.984    0.098   60.949    0.000\n   .x3                2.487    0.093   26.778    0.000\n   .x4                2.823    0.092   30.689    0.000\n   .x5                3.995    0.105   38.183    0.000\n   .x6                1.922    0.079   24.321    0.000\n   .x7                4.432    0.087   51.181    0.000\n   .x8                5.563    0.078   71.214    0.000\n   .x9                5.418    0.079   68.440    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.298    0.232    1.286    0.198\n   .x2                1.334    0.158    8.464    0.000\n   .x3                0.989    0.136    7.271    0.000\n   .x4                0.425    0.069    6.138    0.000\n   .x5                0.456    0.086    5.292    0.000\n   .x6                0.290    0.050    5.780    0.000\n   .x7                0.820    0.125    6.580    0.000\n   .x8                0.510    0.116    4.406    0.000\n   .x9                0.680    0.104    6.516    0.000\n    visual            1.097    0.276    3.967    0.000\n    textual           0.894    0.150    5.963    0.000\n    speed             0.350    0.126    2.778    0.005\n\n\nGroup 2 [Grant-White]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2                0.736    0.155    4.760    0.000\n    x3                0.925    0.166    5.583    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5                0.990    0.087   11.418    0.000\n    x6                0.963    0.085   11.377    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8                1.226    0.187    6.569    0.000\n    x9                1.058    0.165    6.429    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.408    0.098    4.153    0.000\n    speed             0.276    0.076    3.639    0.000\n  textual ~~                                          \n    speed             0.222    0.073    3.022    0.003\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                4.930    0.095   51.696    0.000\n   .x2                6.200    0.092   67.416    0.000\n   .x3                1.996    0.086   23.195    0.000\n   .x4                3.317    0.093   35.625    0.000\n   .x5                4.712    0.096   48.986    0.000\n   .x6                2.469    0.094   26.277    0.000\n   .x7                3.921    0.086   45.819    0.000\n   .x8                5.488    0.087   63.174    0.000\n   .x9                5.327    0.085   62.571    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.715    0.126    5.676    0.000\n   .x2                0.899    0.123    7.339    0.000\n   .x3                0.557    0.103    5.409    0.000\n   .x4                0.315    0.065    4.870    0.000\n   .x5                0.419    0.072    5.812    0.000\n   .x6                0.406    0.069    5.880    0.000\n   .x7                0.600    0.091    6.584    0.000\n   .x8                0.401    0.094    4.249    0.000\n   .x9                0.535    0.089    6.010    0.000\n    visual            0.604    0.160    3.762    0.000\n    textual           0.942    0.152    6.177    0.000\n    speed             0.461    0.118    3.910    0.000\n```\n:::\n:::\n\n\n## Metric (Weak) Invariance\n\nAre the factor loadings equivalent across all groups?\n\n## Code in lavaan, \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# metric invariance\nfit2 <- cfa(HS.model, data = HolzingerSwineford1939, group = \"school\", meanstructure = TRUE, group.equal = \"loadings\")\n\nsummary(fit2, fit.measures = TRUE, remove.unused = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6.17 ended normally after 42 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        60\n  Number of equality constraints                     6\n\n  Number of observations per group:                   \n    Pasteur                                        156\n    Grant-White                                    145\n\nModel Test User Model:\n                                                      \n  Test statistic                               124.044\n  Degrees of freedom                                54\n  P-value (Chi-square)                           0.000\n  Test statistic for each group:\n    Pasteur                                     68.825\n    Grant-White                                 55.219\n\nModel Test Baseline Model:\n\n  Test statistic                               957.769\n  Degrees of freedom                                72\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.921\n  Tucker-Lewis Index (TLI)                       0.895\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -3686.294\n  Loglikelihood unrestricted model (H1)      -3624.272\n                                                      \n  Akaike (AIC)                                7480.587\n  Bayesian (BIC)                              7680.771\n  Sample-size adjusted Bayesian (SABIC)       7509.514\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.093\n  90 Percent confidence interval - lower         0.071\n  90 Percent confidence interval - upper         0.114\n  P-value H_0: RMSEA <= 0.050                    0.001\n  P-value H_0: RMSEA >= 0.080                    0.845\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.072\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\n\nGroup 1 [Pasteur]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2      (.p2.)    0.599    0.100    5.979    0.000\n    x3      (.p3.)    0.784    0.108    7.267    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5      (.p5.)    1.083    0.067   16.049    0.000\n    x6      (.p6.)    0.912    0.058   15.785    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8      (.p8.)    1.201    0.155    7.738    0.000\n    x9      (.p9.)    1.038    0.136    7.629    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.416    0.097    4.271    0.000\n    speed             0.169    0.064    2.643    0.008\n  textual ~~                                          \n    speed             0.176    0.061    2.882    0.004\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                4.941    0.093   52.991    0.000\n   .x2                5.984    0.100   60.096    0.000\n   .x3                2.487    0.094   26.465    0.000\n   .x4                2.823    0.093   30.371    0.000\n   .x5                3.995    0.101   39.714    0.000\n   .x6                1.922    0.081   23.711    0.000\n   .x7                4.432    0.086   51.540    0.000\n   .x8                5.563    0.078   71.087    0.000\n   .x9                5.418    0.079   68.153    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.551    0.137    4.010    0.000\n   .x2                1.258    0.155    8.117    0.000\n   .x3                0.882    0.128    6.884    0.000\n   .x4                0.434    0.070    6.238    0.000\n   .x5                0.508    0.082    6.229    0.000\n   .x6                0.266    0.050    5.294    0.000\n   .x7                0.849    0.114    7.468    0.000\n   .x8                0.515    0.095    5.409    0.000\n   .x9                0.658    0.096    6.865    0.000\n    visual            0.805    0.171    4.714    0.000\n    textual           0.913    0.137    6.651    0.000\n    speed             0.305    0.078    3.920    0.000\n\n\nGroup 2 [Grant-White]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2      (.p2.)    0.599    0.100    5.979    0.000\n    x3      (.p3.)    0.784    0.108    7.267    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5      (.p5.)    1.083    0.067   16.049    0.000\n    x6      (.p6.)    0.912    0.058   15.785    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8      (.p8.)    1.201    0.155    7.738    0.000\n    x9      (.p9.)    1.038    0.136    7.629    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.437    0.099    4.423    0.000\n    speed             0.314    0.079    3.958    0.000\n  textual ~~                                          \n    speed             0.226    0.072    3.144    0.002\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                4.930    0.097   50.763    0.000\n   .x2                6.200    0.091   68.379    0.000\n   .x3                1.996    0.085   23.455    0.000\n   .x4                3.317    0.092   35.950    0.000\n   .x5                4.712    0.100   47.173    0.000\n   .x6                2.469    0.091   27.248    0.000\n   .x7                3.921    0.086   45.555    0.000\n   .x8                5.488    0.087   63.257    0.000\n   .x9                5.327    0.085   62.786    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.645    0.127    5.084    0.000\n   .x2                0.933    0.121    7.732    0.000\n   .x3                0.605    0.096    6.282    0.000\n   .x4                0.329    0.062    5.279    0.000\n   .x5                0.384    0.073    5.270    0.000\n   .x6                0.437    0.067    6.576    0.000\n   .x7                0.599    0.090    6.651    0.000\n   .x8                0.406    0.089    4.541    0.000\n   .x9                0.532    0.086    6.202    0.000\n    visual            0.722    0.161    4.490    0.000\n    textual           0.906    0.136    6.646    0.000\n    speed             0.475    0.109    4.347    0.000\n```\n:::\n:::\n\n\n## We Can Compare These Two Models\n\nWe are aiming for a non-significant Chi-square result, indicating that we can accept the **metric invariance model**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlavTestLRT(fit1, fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nChi-Squared Difference Test\n\n     Df    AIC    BIC  Chisq Chisq diff    RMSEA Df diff Pr(>Chisq)\nfit1 48 7484.4 7706.8 115.85                                       \nfit2 54 7480.6 7680.8 124.04     8.1922 0.049272       6     0.2244\n```\n:::\n:::\n\n\n## Scalar (Strong) Invariance\n\nAre the intercepts the same?\n\n## Code in Lavaan\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# scalar invariance\nfit3 <- cfa(HS.model, data = HolzingerSwineford1939, group = \"school\", meanstructure = TRUE, group.equal = c(\"intercepts\",\"loadings\"))\n\nsummary(fit3, fit.measures = TRUE, remove.unused = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6.17 ended normally after 60 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        63\n  Number of equality constraints                    15\n\n  Number of observations per group:                   \n    Pasteur                                        156\n    Grant-White                                    145\n\nModel Test User Model:\n                                                      \n  Test statistic                               164.103\n  Degrees of freedom                                60\n  P-value (Chi-square)                           0.000\n  Test statistic for each group:\n    Pasteur                                     90.210\n    Grant-White                                 73.892\n\nModel Test Baseline Model:\n\n  Test statistic                               957.769\n  Degrees of freedom                                72\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.882\n  Tucker-Lewis Index (TLI)                       0.859\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -3706.323\n  Loglikelihood unrestricted model (H1)      -3624.272\n                                                      \n  Akaike (AIC)                                7508.647\n  Bayesian (BIC)                              7686.588\n  Sample-size adjusted Bayesian (SABIC)       7534.359\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.107\n  90 Percent confidence interval - lower         0.088\n  90 Percent confidence interval - upper         0.127\n  P-value H_0: RMSEA <= 0.050                    0.000\n  P-value H_0: RMSEA >= 0.080                    0.989\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.082\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\n\nGroup 1 [Pasteur]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2      (.p2.)    0.576    0.101    5.713    0.000\n    x3      (.p3.)    0.798    0.112    7.146    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5      (.p5.)    1.120    0.066   16.965    0.000\n    x6      (.p6.)    0.932    0.056   16.608    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8      (.p8.)    1.130    0.145    7.786    0.000\n    x9      (.p9.)    1.009    0.132    7.667    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.410    0.095    4.293    0.000\n    speed             0.178    0.066    2.687    0.007\n  textual ~~                                          \n    speed             0.180    0.062    2.900    0.004\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1      (.25.)    5.001    0.090   55.760    0.000\n   .x2      (.26.)    6.151    0.077   79.905    0.000\n   .x3      (.27.)    2.271    0.083   27.387    0.000\n   .x4      (.28.)    2.778    0.087   31.953    0.000\n   .x5      (.29.)    4.035    0.096   41.858    0.000\n   .x6      (.30.)    1.926    0.079   24.426    0.000\n   .x7      (.31.)    4.242    0.073   57.975    0.000\n   .x8      (.32.)    5.630    0.072   78.531    0.000\n   .x9      (.33.)    5.465    0.069   79.016    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.555    0.139    3.983    0.000\n   .x2                1.296    0.158    8.186    0.000\n   .x3                0.944    0.136    6.929    0.000\n   .x4                0.445    0.069    6.430    0.000\n   .x5                0.502    0.082    6.136    0.000\n   .x6                0.263    0.050    5.264    0.000\n   .x7                0.888    0.120    7.416    0.000\n   .x8                0.541    0.095    5.706    0.000\n   .x9                0.654    0.096    6.805    0.000\n    visual            0.796    0.172    4.641    0.000\n    textual           0.879    0.131    6.694    0.000\n    speed             0.322    0.082    3.914    0.000\n\n\nGroup 2 [Grant-White]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2      (.p2.)    0.576    0.101    5.713    0.000\n    x3      (.p3.)    0.798    0.112    7.146    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5      (.p5.)    1.120    0.066   16.965    0.000\n    x6      (.p6.)    0.932    0.056   16.608    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8      (.p8.)    1.130    0.145    7.786    0.000\n    x9      (.p9.)    1.009    0.132    7.667    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.427    0.097    4.417    0.000\n    speed             0.329    0.082    4.006    0.000\n  textual ~~                                          \n    speed             0.236    0.073    3.224    0.001\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1      (.25.)    5.001    0.090   55.760    0.000\n   .x2      (.26.)    6.151    0.077   79.905    0.000\n   .x3      (.27.)    2.271    0.083   27.387    0.000\n   .x4      (.28.)    2.778    0.087   31.953    0.000\n   .x5      (.29.)    4.035    0.096   41.858    0.000\n   .x6      (.30.)    1.926    0.079   24.426    0.000\n   .x7      (.31.)    4.242    0.073   57.975    0.000\n   .x8      (.32.)    5.630    0.072   78.531    0.000\n   .x9      (.33.)    5.465    0.069   79.016    0.000\n    visual           -0.148    0.122   -1.211    0.226\n    textual           0.576    0.117    4.918    0.000\n    speed            -0.177    0.090   -1.968    0.049\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.654    0.128    5.094    0.000\n   .x2                0.964    0.123    7.812    0.000\n   .x3                0.641    0.101    6.316    0.000\n   .x4                0.343    0.062    5.534    0.000\n   .x5                0.376    0.073    5.133    0.000\n   .x6                0.437    0.067    6.559    0.000\n   .x7                0.625    0.095    6.574    0.000\n   .x8                0.434    0.088    4.914    0.000\n   .x9                0.522    0.086    6.102    0.000\n    visual            0.708    0.160    4.417    0.000\n    textual           0.870    0.131    6.659    0.000\n    speed             0.505    0.115    4.379    0.000\n```\n:::\n:::\n\n\n## Compare all models\n\nRemember, we want non-significant Chi-square test in order to accept the latest model.\n\nBased on our output, we cannot accept the scalar invariance model, therefore we should not use this model to compare between schools.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlavTestLRT(fit1, fit2, fit3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nChi-Squared Difference Test\n\n     Df    AIC    BIC  Chisq Chisq diff    RMSEA Df diff Pr(>Chisq)    \nfit1 48 7484.4 7706.8 115.85                                           \nfit2 54 7480.6 7680.8 124.04      8.192 0.049272       6     0.2244    \nfit3 60 7508.6 7686.6 164.10     40.059 0.194211       6  4.435e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Why do I have this misfit?\n\nWe can look into **implied** and **observed** statistics\n\nWe can call both **implied** and **observed** per group but we can also **calculate the difference between implied and observed** for each group and explore.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlavInspect(fit3, \"mu\")[[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   x1    x2    x3    x4    x5    x6    x7    x8    x9 \n5.001 6.151 2.271 2.778 4.035 1.926 4.242 5.630 5.465 \n```\n:::\n\n```{.r .cell-code}\nlavInspect(fit3, \"sampstat\")[[1]]$mean\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   x1    x2    x3    x4    x5    x6    x7    x8    x9 \n4.941 5.984 2.487 2.823 3.995 1.922 4.432 5.563 5.418 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlavInspect(fit3, \"mu\")[[1]] - lavInspect(fit3, \"sampstat\")[[1]]$mean\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    x1     x2     x3     x4     x5     x6     x7     x8     x9 \n 0.060  0.167 -0.216 -0.045  0.040  0.003 -0.190  0.067  0.048 \n```\n:::\n:::\n\n\n## Let Us Focus on the Differences per Group\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# group 1\nlavInspect(fit3, \"mu\")[[1]] - lavInspect(fit3, \"sampstat\")[[1]]$mean\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    x1     x2     x3     x4     x5     x6     x7     x8     x9 \n 0.060  0.167 -0.216 -0.045  0.040  0.003 -0.190  0.067  0.048 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# group 2\nlavInspect(fit3, \"mu\")[[2]] - lavInspect(fit3, \"sampstat\")[[2]]$mean\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    x1     x2     x3     x4     x5     x6     x7     x8     x9 \n-0.076 -0.134  0.158  0.037 -0.032 -0.006  0.144 -0.058 -0.041 \n```\n:::\n:::\n\n\n##  Is it the End of the World?\n\nNot really, and quite often your multi-group models may fail **scalar invariance**.\n\nWe can check for **partial invariance**. We do that based on the above difference between **implied** and **observed** means.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# partial invariance\n#we free the items x3 and x7\nfit4 <- cfa(HS.model, data = HolzingerSwineford1939, group = \"school\", meanstructure = TRUE, group.equal = c(\"intercepts\",\"loadings\"),\n            group.partial = c(\"x3 ~ 1\", \"x7 ~ 1\"))\n\nsummary(fit4, fit.measures = TRUE, remove.unused = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6.17 ended normally after 61 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        63\n  Number of equality constraints                    13\n\n  Number of observations per group:                   \n    Pasteur                                        156\n    Grant-White                                    145\n\nModel Test User Model:\n                                                      \n  Test statistic                               129.422\n  Degrees of freedom                                58\n  P-value (Chi-square)                           0.000\n  Test statistic for each group:\n    Pasteur                                     71.170\n    Grant-White                                 58.253\n\nModel Test Baseline Model:\n\n  Test statistic                               957.769\n  Degrees of freedom                                72\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.919\n  Tucker-Lewis Index (TLI)                       0.900\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -3688.983\n  Loglikelihood unrestricted model (H1)      -3624.272\n                                                      \n  Akaike (AIC)                                7477.966\n  Bayesian (BIC)                              7663.322\n  Sample-size adjusted Bayesian (SABIC)       7504.750\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.090\n  90 Percent confidence interval - lower         0.070\n  90 Percent confidence interval - upper         0.111\n  P-value H_0: RMSEA <= 0.050                    0.001\n  P-value H_0: RMSEA >= 0.080                    0.805\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.073\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\n\nGroup 1 [Pasteur]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2      (.p2.)    0.606    0.101    5.988    0.000\n    x3      (.p3.)    0.791    0.109    7.259    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5      (.p5.)    1.120    0.066   16.960    0.000\n    x6      (.p6.)    0.932    0.056   16.606    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8      (.p8.)    1.200    0.155    7.741    0.000\n    x9      (.p9.)    1.041    0.136    7.635    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.404    0.095    4.247    0.000\n    speed             0.168    0.064    2.647    0.008\n  textual ~~                                          \n    speed             0.172    0.060    2.882    0.004\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1      (.25.)    4.914    0.092   53.538    0.000\n   .x2      (.26.)    6.087    0.079   76.999    0.000\n   .x3                2.487    0.094   26.474    0.000\n   .x4      (.28.)    2.778    0.087   31.953    0.000\n   .x5      (.29.)    4.035    0.096   41.861    0.000\n   .x6      (.30.)    1.926    0.079   24.425    0.000\n   .x7                4.432    0.086   51.533    0.000\n   .x8      (.32.)    5.569    0.074   75.328    0.000\n   .x9      (.33.)    5.409    0.070   77.182    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.560    0.137    4.086    0.000\n   .x2                1.267    0.156    8.105    0.000\n   .x3                0.879    0.128    6.850    0.000\n   .x4                0.446    0.069    6.432    0.000\n   .x5                0.502    0.082    6.132    0.000\n   .x6                0.263    0.050    5.258    0.000\n   .x7                0.850    0.114    7.471    0.000\n   .x8                0.516    0.095    5.429    0.000\n   .x9                0.656    0.096    6.852    0.000\n    visual            0.796    0.170    4.691    0.000\n    textual           0.879    0.131    6.693    0.000\n    speed             0.304    0.078    3.918    0.000\n\n\nGroup 2 [Grant-White]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2      (.p2.)    0.606    0.101    5.988    0.000\n    x3      (.p3.)    0.791    0.109    7.259    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5      (.p5.)    1.120    0.066   16.960    0.000\n    x6      (.p6.)    0.932    0.056   16.606    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8      (.p8.)    1.200    0.155    7.741    0.000\n    x9      (.p9.)    1.041    0.136    7.635    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.426    0.097    4.412    0.000\n    speed             0.312    0.079    3.955    0.000\n  textual ~~                                          \n    speed             0.223    0.071    3.163    0.002\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1      (.25.)    4.914    0.092   53.538    0.000\n   .x2      (.26.)    6.087    0.079   76.999    0.000\n   .x3                1.955    0.108   18.170    0.000\n   .x4      (.28.)    2.778    0.087   31.953    0.000\n   .x5      (.29.)    4.035    0.096   41.861    0.000\n   .x6      (.30.)    1.926    0.079   24.425    0.000\n   .x7                3.992    0.094   42.478    0.000\n   .x8      (.32.)    5.569    0.074   75.328    0.000\n   .x9      (.33.)    5.409    0.070   77.182    0.000\n    visual            0.051    0.129    0.393    0.695\n    textual           0.576    0.117    4.918    0.000\n    speed            -0.071    0.089   -0.800    0.424\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1                0.651    0.127    5.138    0.000\n   .x2                0.939    0.122    7.721    0.000\n   .x3                0.603    0.096    6.248    0.000\n   .x4                0.343    0.062    5.532    0.000\n   .x5                0.377    0.073    5.136    0.000\n   .x6                0.437    0.067    6.556    0.000\n   .x7                0.599    0.090    6.655    0.000\n   .x8                0.407    0.089    4.570    0.000\n   .x9                0.531    0.086    6.186    0.000\n    visual            0.715    0.160    4.473    0.000\n    textual           0.870    0.131    6.659    0.000\n    speed             0.475    0.109    4.344    0.000\n```\n:::\n:::\n\n\n## We Compare the Models Again\n\nBased on our output, what are your conclusions?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlavTestLRT(fit1, fit2, fit3, fit4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nChi-Squared Difference Test\n\n     Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr(>Chisq)    \nfit1 48 7484.4 7706.8 115.85                                          \nfit2 54 7480.6 7680.8 124.04      8.192 0.04927       6     0.2244    \nfit4 58 7478.0 7663.3 129.42      5.379 0.04786       4     0.2506    \nfit3 60 7508.6 7686.6 164.10     34.680 0.32950       2  2.946e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Factor Variance Invariance and Error Variance Invariance\n\n-   **Factor Variance Invariance**, constrained to be equal across groups:\n\n    -   Factor Loadings\n\n    -   Covariances\n\n    -   Variances\n\n-   **Error Variance Invariance**, constrained to be equal across groups:\n\n    -   Factor Loadings\n\n    -   Covariances\n\n    -   Variances\n\n    -   Error Terms\n\n## We Are Commonly Using\n\n-   Configural (Absolutely has to hold)\n\n-   Metric (Absolutely has to hold)\n\n-   Scalar (Ideally it should hold, if not we look into partial invariance)\n\n-   **We need all three above in order to compare groups and interpret differences!**\n\n## Additional Invariance Coding (Strict Invariance)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Residual Invariance\nfit5 <- cfa(HS.model, data = HolzingerSwineford1939, group = \"school\", meanstructure = TRUE, group.equal = c(\"intercepts\",\"loadings\", \"residuals\"),\n            group.partial = c(\"x3 ~ 1\", \"x7 ~ 1\"))\n\nsummary(fit5, fit.measures = TRUE, remove.unused = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6.17 ended normally after 59 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        63\n  Number of equality constraints                    22\n\n  Number of observations per group:                   \n    Pasteur                                        156\n    Grant-White                                    145\n\nModel Test User Model:\n                                                      \n  Test statistic                               147.260\n  Degrees of freedom                                67\n  P-value (Chi-square)                           0.000\n  Test statistic for each group:\n    Pasteur                                     79.438\n    Grant-White                                 67.822\n\nModel Test Baseline Model:\n\n  Test statistic                               957.769\n  Degrees of freedom                                72\n  P-value                                        0.000\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.909\n  Tucker-Lewis Index (TLI)                       0.903\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -3697.902\n  Loglikelihood unrestricted model (H1)      -3624.272\n                                                      \n  Akaike (AIC)                                7477.804\n  Bayesian (BIC)                              7629.796\n  Sample-size adjusted Bayesian (SABIC)       7499.767\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.089\n  90 Percent confidence interval - lower         0.070\n  90 Percent confidence interval - upper         0.109\n  P-value H_0: RMSEA <= 0.050                    0.001\n  P-value H_0: RMSEA >= 0.080                    0.791\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.079\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\n\nGroup 1 [Pasteur]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2      (.p2.)    0.624    0.104    5.986    0.000\n    x3      (.p3.)    0.825    0.113    7.288    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5      (.p5.)    1.125    0.066   17.130    0.000\n    x6      (.p6.)    0.934    0.056   16.749    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8      (.p8.)    1.194    0.162    7.355    0.000\n    x9      (.p9.)    1.068    0.146    7.308    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.363    0.094    3.875    0.000\n    speed             0.165    0.063    2.627    0.009\n  textual ~~                                          \n    speed             0.168    0.060    2.807    0.005\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1      (.25.)    4.910    0.093   52.673    0.000\n   .x2      (.26.)    6.072    0.079   76.983    0.000\n   .x3                2.487    0.090   27.772    0.000\n   .x4      (.28.)    2.784    0.086   32.195    0.000\n   .x5      (.29.)    4.029    0.096   41.811    0.000\n   .x6      (.30.)    1.927    0.081   23.746    0.000\n   .x7                4.432    0.082   53.865    0.000\n   .x8      (.32.)    5.568    0.073   75.821    0.000\n   .x9      (.33.)    5.411    0.071   76.698    0.000\n    visual            0.000                           \n    textual           0.000                           \n    speed             0.000                           \n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1      (.10.)    0.636    0.101    6.303    0.000\n   .x2      (.11.)    1.101    0.100   10.973    0.000\n   .x3      (.12.)    0.724    0.085    8.529    0.000\n   .x4      (.13.)    0.383    0.047    8.096    0.000\n   .x5      (.14.)    0.435    0.057    7.613    0.000\n   .x6      (.15.)    0.353    0.042    8.336    0.000\n   .x7      (.16.)    0.738    0.076    9.696    0.000\n   .x8      (.17.)    0.479    0.073    6.592    0.000\n   .x9      (.18.)    0.580    0.069    8.386    0.000\n    visual            0.776    0.164    4.737    0.000\n    textual           0.893    0.131    6.826    0.000\n    speed             0.318    0.080    3.990    0.000\n\n\nGroup 2 [Grant-White]:\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual =~                                           \n    x1                1.000                           \n    x2      (.p2.)    0.624    0.104    5.986    0.000\n    x3      (.p3.)    0.825    0.113    7.288    0.000\n  textual =~                                          \n    x4                1.000                           \n    x5      (.p5.)    1.125    0.066   17.130    0.000\n    x6      (.p6.)    0.934    0.056   16.749    0.000\n  speed =~                                            \n    x7                1.000                           \n    x8      (.p8.)    1.194    0.162    7.355    0.000\n    x9      (.p9.)    1.068    0.146    7.308    0.000\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n  visual ~~                                           \n    textual           0.421    0.095    4.444    0.000\n    speed             0.315    0.078    4.029    0.000\n  textual ~~                                          \n    speed             0.223    0.071    3.148    0.002\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1      (.25.)    4.910    0.093   52.673    0.000\n   .x2      (.26.)    6.072    0.079   76.983    0.000\n   .x3                1.951    0.114   17.044    0.000\n   .x4      (.28.)    2.784    0.086   32.195    0.000\n   .x5      (.29.)    4.029    0.096   41.811    0.000\n   .x6      (.30.)    1.927    0.081   23.746    0.000\n   .x7                3.992    0.099   40.135    0.000\n   .x8      (.32.)    5.568    0.073   75.821    0.000\n   .x9      (.33.)    5.411    0.071   76.698    0.000\n    visual            0.054    0.128    0.423    0.672\n    textual           0.575    0.118    4.888    0.000\n    speed            -0.071    0.089   -0.805    0.421\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)\n   .x1      (.10.)    0.636    0.101    6.303    0.000\n   .x2      (.11.)    1.101    0.100   10.973    0.000\n   .x3      (.12.)    0.724    0.085    8.529    0.000\n   .x4      (.13.)    0.383    0.047    8.096    0.000\n   .x5      (.14.)    0.435    0.057    7.613    0.000\n   .x6      (.15.)    0.353    0.042    8.336    0.000\n   .x7      (.16.)    0.738    0.076    9.696    0.000\n   .x8      (.17.)    0.479    0.073    6.592    0.000\n   .x9      (.18.)    0.580    0.069    8.386    0.000\n    visual            0.664    0.150    4.436    0.000\n    textual           0.876    0.132    6.620    0.000\n    speed             0.446    0.109    4.095    0.000\n```\n:::\n:::\n\n\n## Compare Models\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlavTestLRT(fit1, fit2, fit3, fit4, fit5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nChi-Squared Difference Test\n\n     Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr(>Chisq)    \nfit1 48 7484.4 7706.8 115.85                                          \nfit2 54 7480.6 7680.8 124.04      8.192 0.04927       6     0.2244    \nfit4 58 7478.0 7663.3 129.42      5.379 0.04786       4     0.2506    \nfit3 60 7508.6 7686.6 164.10     34.680 0.32950       2  2.946e-08 ***\nfit5 67 7477.8 7629.8 147.26    -16.842 0.00000       7     1.0000    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Some Additional group.equal arguments\n\n-   `intercepts`: the intercepts of the observed variables\n\n-   `means`: the intercepts/means of the latent variables\n\n-   `residuals`: the residual variances of the observed variables\n\n-   `residual.covariances`: the residual covariances of the observed variables\n\n-   `lv.variances`: the (residual) variances of the latent variables\n\n-   `lv.covariances`: the (residual) covariances of the latent variables\n\n-   `regressions`: all regression coefficients in the model\n\n## In Conclusion\n\nMake sure to read Principles and Practice of Structural Equation Modeling, Kline, pages 396-402.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    // dispatch for htmlwidgets\r\n    function fireSlideEnter() {\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n    }\r\n\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n      fireSlideEnter();\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}